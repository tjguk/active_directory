

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>active_directory Cookbook &mdash; active_directory v1.0rc1 documentation</title>
    <link rel="stylesheet" href="_static/active_directory.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '#',
        VERSION:     '1.0rc1',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="active_directory v1.0rc1 documentation" href="index.html" />
    <link rel="next" title="active_directory – Windows Active Directory Management" href="active_directory.html" />
    <link rel="prev" title="active_directory Tutorial" href="tutorial.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="active_directory.html" title="active_directory – Windows Active Directory Management"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="active_directory Tutorial"
             accesskey="P">previous</a> |</li>
        <li><a href="contents.html">active_directory v1.0rc1 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="active-directory-cookbook">
<h1>active_directory Cookbook<a class="headerlink" href="#active-directory-cookbook" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>These examples assume you are using the <a class="reference external" href="http://timgolden.me.uk/python/active_directory.html">active_directory module</a>
from this site. The following are examples of useful things that could be done with this module on win32 machines.
It hardly scratches the surface of AD, but that&#8217;s probably as well.</p>
<p>The following examples, except where stated otherwise, all assume that you are connecting to the current machine.
To connect to a remote machine, simply specify the remote machine name in the AD constructor, and by the wonders
of DCOM, all should be well:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">active_directory</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">ad</span> <span class="p">(</span><span class="s">&quot;other machine&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="show-the-interface-for-the-create-method-of-a-win32-process-class">
<h3>Show the interface for the .Create method of a Win32_Process class<a class="headerlink" href="#show-the-interface-for-the-create-method-of-a-win32-process-class" title="Permalink to this headline">¶</a></h3>
<p>The wmi module tries to take the hard work out of WMI methods by querying the method for its in and out parameters,
accepting the in parameters as Python keyword params and returning the output parameters as an tuple return value.
The function which is masquerading as the WMI method has a __doc__ value which shows the input and return values.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">wmi</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">wmi</span><span class="o">.</span><span class="n">WMI</span> <span class="p">()</span>

<span class="k">print</span> <span class="n">c</span><span class="o">.</span><span class="n">Win32_Process</span><span class="o">.</span><span class="n">Create</span>
</pre></div>
</div>
</div>
<div class="section" id="run-notepad-wait-until-it-s-closed-and-then-show-its-text">
<h3>Run notepad, wait until it&#8217;s closed and then show its text<a class="headerlink" href="#run-notepad-wait-until-it-s-closed-and-then-show-its-text" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This is an example of running a process and knowing when it&#8217;s finished, not of manipulating text typed into
Notepad. So I&#8217;m simply relying on the fact that I specify what file notepad should open and then examining the
contents of that afterwards.</p>
<p class="last">This one won&#8217;t work as shown on a remote machine because, for security reasons, processes started on a remote
machine do not have an interface (ie you can&#8217;t see them on the desktop). The most likely use for this sort of
technique on a remote server to run a setup.exe and then, say, reboot once it&#8217;s completed.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">wmi</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">wmi</span><span class="o">.</span><span class="n">WMI</span> <span class="p">()</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s">r&quot;c:\temp\temp.txt&quot;</span>
<span class="n">process</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Win32_Process</span>
<span class="n">process_id</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">Create</span> <span class="p">(</span><span class="n">CommandLine</span><span class="o">=</span><span class="s">&quot;notepad.exe &quot;</span> <span class="o">+</span> <span class="n">filename</span><span class="p">)</span>
<span class="n">watcher</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">watch_for</span> <span class="p">(</span>
  <span class="n">notification_type</span><span class="o">=</span><span class="s">&quot;Deletion&quot;</span><span class="p">,</span>
  <span class="n">wmi_class</span><span class="o">=</span><span class="s">&quot;Win32_Process&quot;</span><span class="p">,</span>
  <span class="n">delay_secs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
  <span class="n">ProcessId</span><span class="o">=</span><span class="n">process_id</span>
<span class="p">)</span>

<span class="n">watcher</span> <span class="p">()</span>
<span class="k">print</span> <span class="s">&quot;This is what you wrote:&quot;</span>
<span class="k">print</span> <span class="nb">open</span> <span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">.</span><span class="n">read</span> <span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="active_directory.html" title="active_directory – Windows Active Directory Management"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial.html" title="active_directory Tutorial"
             >previous</a> |</li>
        <li><a href="contents.html">active_directory v1.0rc1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Tim Golden.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.
    </div>
  </body>
</html>